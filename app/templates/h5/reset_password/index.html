<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>é‡ç½®å¯†ç </title>
</head>

<body>
<h2>ğŸ” é‡ç½®å¯†ç </h2>

<div>
  <label>æ–°å¯†ç :</label><br>
  <input type="password" id="pwd" /><br><br>

  <label>ç¡®è®¤æ–°å¯†ç :</label><br>
  <input type="password" id="pwd2" /><br><br>

  <button onclick="submitReset()">æäº¤</button>
</div>

<p id="msg"></p>

<script>
const urlParams = new URLSearchParams(window.location.search);
const oobCode = urlParams.get("oobCode");

if (!oobCode) {
  document.getElementById("msg").innerText = "é“¾æ¥æ— æ•ˆæˆ–å·²è¿‡æœŸ âŒ";
}

async function submitReset() {
  const pwd = document.getElementById("pwd").value;
  const pwd2 = document.getElementById("pwd2").value;

  if (pwd !== pwd2) {
    return document.getElementById("msg").innerText = "ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´ âŒ";
  }

  const res = await fetch("https://your-api.com/v1/forgot/password/reset", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      oobCode: oobCode,
      new_password: pwd
    })
  });

  const data = await res.json();

  if (data.code === 2002) {
    document.getElementById("msg").innerText = "âœ… å¯†ç ä¿®æ”¹æˆåŠŸï¼Œè¯·é‡æ–°ç™»å½•";
    setTimeout(() => location.href = "/login.html", 2000);
  } else {
    document.getElementById("msg").innerText = "âŒ " + data.msg;
  }
}
</script>

</body>
</html>
